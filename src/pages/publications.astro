---
// src/pages/publications.astro
import BaseLayout from "../layouts/BaseLayout.astro";
import { getCollection } from "astro:content";

const pubs = await getCollection("publications");
const sorted = pubs.sort((a, b) => (b.data.year ?? 0) - (a.data.year ?? 0));
---
<BaseLayout title="Publications — Kareena Salim Lakhani">
  <section class="py-12">
    <h1 class="font-display text-2xl">Publications</h1>
    <p class="mt-2 text-support2">Bib-style entries with links and a BibTeX toggle.</p>

    <div class="mt-6 space-y-4">
      {sorted.map(p => (
        <article class="bg-white p-6 rounded-md shadow-soft">
          <div class="text-sm text-support2">
            {(p.data.authors ?? []).join(", ")} • {p.data.venue ?? "Venue TBA"} • {p.data.year ?? "Year"}
          </div>
          <h2 class="mt-1 font-semibold">{p.data.title}</h2>

          <div class="mt-3 flex gap-3 text-sm">
            {p.data.pdf && <a class="text-ink hover:underline" href={p.data.pdf} target="_blank" rel="noopener">Link</a>}
            {p.data.code && <a class="text-ink hover:underline" href={p.data.code} target="_blank" rel="noopener">Code</a>}
          </div>

          {p.data.bibtex && (
            <details class="mt-4">
              <summary class="cursor-pointer text-sm text-ink">Show BibTeX</summary>
              <pre class="mt-2 p-4 rounded-md bg-bg text-xs overflow-auto">{p.data.bibtex}</pre>
            </details>
          )}
        </article>
      ))}
    </div>
  </section>
</BaseLayout>

